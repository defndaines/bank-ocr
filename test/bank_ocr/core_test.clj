(ns bank-ocr.core-test
  (:require [clojure.test :refer :all]
            [bank-ocr.core :refer :all]
            [clojure.string :as string]))

(deftest user-story-1-test
  (testing "Use cases from the original document."
    (is (= "000000000"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   "| || || || || || || || || |"
                   "|_||_||_||_||_||_||_||_||_|"])))
    (is (= "111111111"
           (parse [""
                   "  |  |  |  |  |  |  |  |  |"
                   "  |  |  |  |  |  |  |  |  |"])))
    (is (= "222222222"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   " _| _| _| _| _| _| _| _| _|"
                   "|_ |_ |_ |_ |_ |_ |_ |_ |_ "])))
    (is (= "333333333"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   " _| _| _| _| _| _| _| _| _|"
                   " _| _| _| _| _| _| _| _| _|"])))
    (is (= "444444444"
           (parse [""
                   "|_||_||_||_||_||_||_||_||_|"
                   "  |  |  |  |  |  |  |  |  |"])))
    (is (= "555555555"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   "|_ |_ |_ |_ |_ |_ |_ |_ |_ "
                   " _| _| _| _| _| _| _| _| _|"])))
    (is (= "666666666"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   "|_ |_ |_ |_ |_ |_ |_ |_ |_ "
                   "|_||_||_||_||_||_||_||_||_|"])))
    (is (= "777777777"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   "  |  |  |  |  |  |  |  |  |"
                   "  |  |  |  |  |  |  |  |  |"])))
    (is (= "888888888"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   "|_||_||_||_||_||_||_||_||_|"
                   "|_||_||_||_||_||_||_||_||_|"])))
    (is (= "999999999"
           (parse [" _  _  _  _  _  _  _  _  _ "
                   "|_||_||_||_||_||_||_||_||_|"
                   " _| _| _| _| _| _| _| _| _|"])))
    (is (= "123456789"
           (parse ["    _  _     _  _  _  _  _ "
                   "  | _| _||_||_ |_   ||_||_|"
                   "  ||_  _|  | _||_|  ||_| _|"])))))


(deftest user-story-2-test
  (testing "Check valid checksums of account numbers."
    (is (valid? "457508000")))
  (testing "Check invalid checksums of account numbers."
    (is (not (valid? "664371495")))
    (is (not (valid? "86110??36")))))


(deftest user-story-3-test
  (testing "Use cases from the original document."
    (is (= "000000051"
           (parse [" _  _  _  _  _  _  _  _    "
                   "| || || || || || || ||_   |"
                   "|_||_||_||_||_||_||_| _|  |"])))
    (is (= "49006771?"
           (parse ["    _  _  _  _  _  _     _ "
                   "|_||_|| || ||_   |  |  | _ "
                   "  | _||_||_||_|  |  |  | _|"])))
    (is (= "1234?678?"
           (parse ["    _  _     _  _  _  _  _ "
                   "  | _| _||_| _ |_   ||_||_|"
                   "  ||_  _|  | _||_|  ||_| _ "])))))
